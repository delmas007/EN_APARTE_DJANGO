{% extends 'base.html' %}
{% load static %}
{% block css %}
    <style>
        body {
            background-color: #f4f4f4;
            padding: 20px;
        }

        form {
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            border-radius: 8px;
        }

        .error {
            color: red;
            margin-bottom: 10px;
        }

        label {
            font-weight: bold;
        }

    </style>
{% endblock %}
{% block content%}
    <body>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <form id="appointmentForm">

                    {{ form}}
                    <button type="submit" class="btn btn-success">Prendre rendez-vous</button>

                    <div id="error-message" class="error">Disponibilité: Lundi-Vendredi 8H-18H</div>
                </form>

                <script>
                    $(document).ready(function() {
                        // Activer le datepicker
                        $("#id_date_rendez_vous").datepicker({
                            minDate: 0, // La date minimale est aujourd'hui
                            maxDate: "+1w", // La date maximale est une semaine à partir d'aujourd'hui
                            beforeShowDay: function(date) {
                                // Désactiver les week-ends
                                var day = date.getDay();
                                return [(day !== 0 && day !== 6), ''];
                            },
                            dateFormat: 'yy-mm-dd', // Format de date
                        });

                        // Générer les heures même en cas de changement de date
                        $("#id_date_rendez_vous").change(function() {
                            generateEvenHours();
                        });
                    });

                    function generateEvenHours() {
                        var select = document.getElementById('id_heure_rendez_vous');
                        select.innerHTML = '';
                        for (var i = 8; i <= 16; i += 2) {
                            var formattedHour = ('0' + i).slice(-2);
                            var heurSuivant = (i + 2);
                            var option = document.createElement('option');
                            option.value = formattedHour + ':00';
                            if (i === 12) {
                                option.text = '';
                                option.disabled = true;
                            } else {
                                option.text = formattedHour + ':00' + '-' + heurSuivant + ':00';
                            }
                            select.appendChild(option);
                        }
                    }
                    generateEvenHours();
                </script>

            </div>
        </div>
    </div>
    </body>
{% endblock %}
